..
.. SPDX-License-Identifier: Apache-2.0
..

:github_url: https://github.com/LiJunBJZhu/i_collection_core/tree/master/plugins/modules/ibmi_script.py


ibmi_script -- Execute a local cl/sql script file on a remote ibm i node.
=========================================================================

.. contents::
   :local:
   :depth: 1


Synopsis
--------

The ibmi_script plugin transfer a local cl/sql script file to a remote ibm i node and execute.

Only support cl/sql script file by now.

For sql script, use RUNSQLSTM to process

For non-cl/sql script, use the script plugin instead.






Parameters
----------

  src (True, str, None)
    Script file path on control node.

    The path can be absolute or relative.


  severity_level (optional, int, 10)
    When run sql script, specifies whether the processing is successful, based on the severity of the messages generated by the processing of the SQL statements.

    If errors that are greater than the value specified for this parameter occur during processing, no more statements are run and the statements are rolled back if they are running under commitment control.

    Only works for sql script


  type (True, str, None)
    Specify the script file type.

    Only support CL or SQL script by now.


  asp_group (optional, str, )
    Specifies the name of the auxiliary storage pool (ASP) group to set for the current thread.

    The ASP group name is the name of the primary ASP device within the ASP group.


  parameters (optional, str,  )
    The parameters that RUNSQLSTM command will take. All other parameters need to be specified here.

    The default values of parameters for RUNSQLSTM will be taken if not specified.

    Only works for sql script





Notes
-----

.. note::
   - Ansible hosts file need to specify ansible_python_interpreter=/QOpenSys/pkgs/bin/python3(or python2)
   - For cl script, the command supports line breaks. When a command ends, add ':' at the end of each command or empty the next line. Otherwise program will not consider it is the end of a command.




Examples
--------

.. code-block:: yaml+jinja

    
    - name: Execute test.cl on a remote ibm i node
      ibmi_script:
        src: '/tmp/test.cl'
        type: 'CL'

    - name: Execute testsql.sql on a remote ibm i node
      ibmi_script_execute:
        src: '/home/testsql.sql'
        type: 'SQL'
        severity_level: 40
        parameters: 'DATFMT(*USA)'



Return Values
-------------

  stderr_lines (always, list, ['Execute command crtlib testlib failed.'])
    The standard error split in lines


  stderr (always, str, Execute command crtlib testlib failed.)
    The standard error


  stdout (always, str, Successfully execute script file /tmp/test.cl)
    The standard output


  stdout_lines (always, list, ['Successfully execute script file /tmp/test.cl'])
    The standard output split in lines


  delta (always, str, 0:00:00.307534)
    The execution delta time.


  rc (always, int, 255)
    The action return code (0 means success, non-zero means failure)





Status
------




- This  is not guaranteed to have a backwards compatible interface. *[preview]*


- This  is maintained by community.



Authors
~~~~~~~

- Peng Zeng Yu (@pengzengyufish)

